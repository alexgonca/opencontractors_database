DROP TABLE IF EXISTS temp_contract;

CREATE TABLE temp_contract (
  unique_transaction_id                            TEXT,
  transaction_status                               TEXT,
  dollarsobligated                                 TEXT,
  baseandexercisedoptionsvalue                     TEXT,
  baseandalloptionsvalue                           TEXT,
  maj_agency_cat                                   TEXT,
  mod_agency                                       TEXT,
  maj_fund_agency_cat                              TEXT,
  contractingofficeagencyid                        TEXT,
  contractingofficeid                              TEXT,
  fundingrequestingagencyid                        TEXT,
  fundingrequestingofficeid                        TEXT,
  fundedbyforeignentity                            TEXT,
  signeddate                                       TEXT,
  effectivedate                                    TEXT,
  currentcompletiondate                            TEXT,
  ultimatecompletiondate                           TEXT,
  lastdatetoorder                                  TEXT,
  contractactiontype                               TEXT,
  reasonformodification                            TEXT,
  typeofcontractpricing                            TEXT,
  priceevaluationpercentdifference                 TEXT,
  subcontractplan                                  TEXT,
  lettercontract                                   TEXT,
  multiyearcontract                                TEXT,
  performancebasedservicecontract                  TEXT,
  majorprogramcode                                 TEXT,
  contingencyhumanitarianpeacekeepingoperation     TEXT,
  contractfinancing                                TEXT,
  costorpricingdata                                TEXT,
  costaccountingstandardsclause                    TEXT,
  descriptionofcontractrequirement                 TEXT,
  purchasecardaspaymentmethod                      TEXT,
  numberofactions                                  TEXT,
  nationalinterestactioncode                       TEXT,
  progsourceagency                                 TEXT,
  progsourceaccount                                TEXT,
  progsourcesubacct                                TEXT,
  account_title                                    TEXT,
  rec_flag                                         TEXT,
  typeofidc                                        TEXT,
  multipleorsingleawardidc                         TEXT,
  programacronym                                   TEXT,
  vendorname                                       TEXT,
  vendoralternatename                              TEXT,
  vendorlegalorganizationname                      TEXT,
  vendordoingasbusinessname                        TEXT,
  divisionname                                     TEXT,
  divisionnumberorofficecode                       TEXT,
  vendorenabled                                    TEXT,
  vendorlocationdisableflag                        TEXT,
  ccrexception                                     TEXT,
  streetaddress                                    TEXT,
  streetaddress2                                   TEXT,
  streetaddress3                                   TEXT,
  city                                             TEXT,
  state                                            TEXT,
  zipcode                                          TEXT,
  vendorcountrycode                                TEXT,
  vendor_state_code                                TEXT,
  vendor_cd                                        TEXT,
  congressionaldistrict                            TEXT,
  vendorsitecode                                   TEXT,
  vendoralternatesitecode                          TEXT,
  dunsnumber                                       TEXT,
  parentdunsnumber                                 TEXT,
  phoneno                                          TEXT,
  faxno                                            TEXT,
  registrationdate                                 TEXT,
  renewaldate                                      TEXT,
  mod_parent                                       TEXT,
  locationcode                                     TEXT,
  statecode                                        TEXT,
  PlaceofPerformanceCity                           TEXT,
  pop_state_code                                   TEXT,
  placeofperformancecountrycode                    TEXT,
  placeofperformancezipcode                        TEXT,
  pop_cd                                           TEXT,
  placeofperformancecongressionaldistrict          TEXT,
  psc_cat                                          TEXT,
  productorservicecode                             TEXT,
  systemequipmentcode                              TEXT,
  claimantprogramcode                              TEXT,
  principalnaicscode                               TEXT,
  informationtechnologycommercialitemcategory      TEXT,
  gfe_gfp                                          TEXT,
  useofepadesignatedproducts                       TEXT,
  recoveredmaterialclauses                         TEXT,
  seatransportation                                TEXT,
  contractbundling                                 TEXT,
  consolidatedcontract                             TEXT,
  countryoforigin                                  TEXT,
  placeofmanufacture                               TEXT,
  manufacturingorganizationtype                    TEXT,
  agencyid                                         TEXT,
  piid                                             TEXT,
  modnumber                                        TEXT,
  transactionnumber                                TEXT,
  fiscal_year                                      TEXT,
  idvagencyid                                      TEXT,
  idvpiid                                          TEXT,
  idvmodificationnumber                            TEXT,
  solicitationid                                   TEXT,
  extentcompeted                                   TEXT,
  reasonnotcompeted                                TEXT,
  numberofoffersreceived                           TEXT,
  commercialitemacquisitionprocedures              TEXT,
  commercialitemtestprogram                        TEXT,
  smallbusinesscompetitivenessdemonstrationprogram TEXT,
  a76action                                        TEXT,
  competitiveprocedures                            TEXT,
  solicitationprocedures                           TEXT,
  typeofsetaside                                   TEXT,
  localareasetaside                                TEXT,
  evaluatedpreference                              TEXT,
  fedbizopps                                       TEXT,
  research                                         TEXT,
  statutoryexceptiontofairopportunity              TEXT,
  organizationaltype                               TEXT,
  numberofemployees                                TEXT,
  annualrevenue                                    TEXT,
  firm8aflag                                       TEXT,
  hubzoneflag                                      TEXT,
  sdbflag                                          TEXT,
  issbacertifiedsmalldisadvantagedbusiness         TEXT,
  shelteredworkshopflag                            TEXT,
  hbcuflag                                         TEXT,
  educationalinstitutionflag                       TEXT,
  womenownedflag                                   TEXT,
  veteranownedflag                                 TEXT,
  srdvobflag                                       TEXT,
  localgovernmentflag                              TEXT,
  minorityinstitutionflag                          TEXT,
  aiobflag                                         TEXT,
  stategovernmentflag                              TEXT,
  federalgovernmentflag                            TEXT,
  minorityownedbusinessflag                        TEXT,
  apaobflag                                        TEXT,
  tribalgovernmentflag                             TEXT,
  baobflag                                         TEXT,
  naobflag                                         TEXT,
  saaobflag                                        TEXT,
  nonprofitorganizationflag                        TEXT,
  isothernotforprofitorganization                  TEXT,
  isforprofitorganization                          TEXT,
  isfoundation                                     TEXT,
  haobflag                                         TEXT,
  ishispanicservicinginstitution                   TEXT,
  emergingsmallbusinessflag                        TEXT,
  hospitalflag                                     TEXT,
  contractingofficerbusinesssizedetermination      TEXT,
  is1862landgrantcollege                           TEXT,
  is1890landgrantcollege                           TEXT,
  is1994landgrantcollege                           TEXT,
  isveterinarycollege                              TEXT,
  isveterinaryhospital                             TEXT,
  isprivateuniversityorcollege                     TEXT,
  isschoolofforestry                               TEXT,
  isstatecontrolledinstitutionofhigherlearning     TEXT,
  isserviceprovider                                TEXT,
  receivescontracts                                TEXT,
  receivesgrants                                   TEXT,
  receivescontractsandgrants                       TEXT,
  isairportauthority                               TEXT,
  iscouncilofgovernments                           TEXT,
  ishousingauthoritiespublicortribal               TEXT,
  isinterstateentity                               TEXT,
  isplanningcommission                             TEXT,
  isportauthority                                  TEXT,
  istransitauthority                               TEXT,
  issubchapterscorporation                         TEXT,
  islimitedliabilitycorporation                    TEXT,
  isforeignownedandlocated                         TEXT,
  isarchitectureandengineering                     TEXT,
  isdotcertifieddisadvantagedbusinessenterprise    TEXT,
  iscitylocalgovernment                            TEXT,
  iscommunitydevelopedcorporationownedfirm         TEXT,
  iscommunitydevelopmentcorporation                TEXT,
  isconstructionfirm                               TEXT,
  ismanufacturerofgoods                            TEXT,
  iscorporateentitynottaxexempt                    TEXT,
  iscountylocalgovernment                          TEXT,
  isdomesticshelter                                TEXT,
  isfederalgovernmentagency                        TEXT,
  isfederallyfundedresearchanddevelopmentcorp      TEXT,
  isforeigngovernment                              TEXT,
  isindiantribe                                    TEXT,
  isintermunicipallocalgovernment                  TEXT,
  isinternationalorganization                      TEXT,
  islaborsurplusareafirm                           TEXT,
  islocalgovernmentowned                           TEXT,
  ismunicipalitylocalgovernment                    TEXT,
  isnativehawaiianownedorganizationorfirm          TEXT,
  isotherbusinessororganization                    TEXT,
  isotherminorityowned                             TEXT,
  ispartnershiporlimitedliabilitypartnership       TEXT,
  isschooldistrictlocalgovernment                  TEXT,
  issmallagriculturalcooperative                   TEXT,
  issoleproprietorship                             TEXT,
  istownshiplocalgovernment                        TEXT,
  istriballyownedfirm                              TEXT,
  istribalcollege                                  TEXT,
  isalaskannativeownedcorporationorfirm            TEXT,
  iscorporateentitytaxexempt                       TEXT,
  iswomenownedsmallbusiness                        TEXT,
  isecondisadvwomenownedsmallbusiness              TEXT,
  isjointventurewomenownedsmallbusiness            TEXT,
  isjointventureecondisadvwomenownedsmallbusiness  TEXT,
  walshhealyact                                    TEXT,
  servicecontractact                               TEXT,
  davisbaconact                                    TEXT,
  clingercohenact                                  TEXT,
  otherstatutoryauthority                          TEXT,
  prime_awardee_executive1                         TEXT,
  prime_awardee_executive1_compensation            TEXT,
  prime_awardee_executive2                         TEXT,
  prime_awardee_executive2_compensation            TEXT,
  prime_awardee_executive3                         TEXT,
  prime_awardee_executive3_compensation            TEXT,
  prime_awardee_executive4                         TEXT,
  prime_awardee_executive4_compensation            TEXT,
  prime_awardee_executive5                         TEXT,
  prime_awardee_executive5_compensation            TEXT,
  interagencycontractingauthority                  TEXT,
  last_modified_date                               TEXT
);

CREATE TABLE IF NOT EXISTS contract_csv (
  unique_transaction_id                            TEXT,
  transaction_status                               TEXT,
  dollarsobligated                                 TEXT,
  baseandexercisedoptionsvalue                     TEXT,
  baseandalloptionsvalue                           TEXT,
  maj_agency_cat                                   TEXT,
  mod_agency                                       TEXT,
  maj_fund_agency_cat                              TEXT,
  contractingofficeagencyid                        TEXT,
  contractingofficeid                              TEXT,
  fundingrequestingagencyid                        TEXT,
  fundingrequestingofficeid                        TEXT,
  fundedbyforeignentity                            TEXT,
  signeddate                                       TEXT,
  effectivedate                                    TEXT,
  currentcompletiondate                            TEXT,
  ultimatecompletiondate                           TEXT,
  lastdatetoorder                                  TEXT,
  contractactiontype                               TEXT,
  reasonformodification                            TEXT,
  typeofcontractpricing                            TEXT,
  priceevaluationpercentdifference                 TEXT,
  subcontractplan                                  TEXT,
  lettercontract                                   TEXT,
  multiyearcontract                                TEXT,
  performancebasedservicecontract                  TEXT,
  majorprogramcode                                 TEXT,
  contingencyhumanitarianpeacekeepingoperation     TEXT,
  contractfinancing                                TEXT,
  costorpricingdata                                TEXT,
  costaccountingstandardsclause                    TEXT,
  descriptionofcontractrequirement                 TEXT,
  purchasecardaspaymentmethod                      TEXT,
  numberofactions                                  TEXT,
  nationalinterestactioncode                       TEXT,
  progsourceagency                                 TEXT,
  progsourceaccount                                TEXT,
  progsourcesubacct                                TEXT,
  account_title                                    TEXT,
  rec_flag                                         TEXT,
  typeofidc                                        TEXT,
  multipleorsingleawardidc                         TEXT,
  programacronym                                   TEXT,
  vendorname                                       TEXT,
  vendoralternatename                              TEXT,
  vendorlegalorganizationname                      TEXT,
  vendordoingasbusinessname                        TEXT,
  divisionname                                     TEXT,
  divisionnumberorofficecode                       TEXT,
  vendorenabled                                    TEXT,
  vendorlocationdisableflag                        TEXT,
  ccrexception                                     TEXT,
  streetaddress                                    TEXT,
  streetaddress2                                   TEXT,
  streetaddress3                                   TEXT,
  city                                             TEXT,
  state                                            TEXT,
  zipcode                                          TEXT,
  vendorcountrycode                                TEXT,
  vendor_state_code                                TEXT,
  vendor_cd                                        TEXT,
  congressionaldistrict                            TEXT,
  vendorsitecode                                   TEXT,
  vendoralternatesitecode                          TEXT,
  dunsnumber                                       TEXT,
  parentdunsnumber                                 TEXT,
  phoneno                                          TEXT,
  faxno                                            TEXT,
  registrationdate                                 TEXT,
  renewaldate                                      TEXT,
  mod_parent                                       TEXT,
  locationcode                                     TEXT,
  statecode                                        TEXT,
  PlaceofPerformanceCity                           TEXT,
  pop_state_code                                   TEXT,
  placeofperformancecountrycode                    TEXT,
  placeofperformancezipcode                        TEXT,
  pop_cd                                           TEXT,
  placeofperformancecongressionaldistrict          TEXT,
  psc_cat                                          TEXT,
  productorservicecode                             TEXT,
  systemequipmentcode                              TEXT,
  claimantprogramcode                              TEXT,
  principalnaicscode                               TEXT,
  informationtechnologycommercialitemcategory      TEXT,
  gfe_gfp                                          TEXT,
  useofepadesignatedproducts                       TEXT,
  recoveredmaterialclauses                         TEXT,
  seatransportation                                TEXT,
  contractbundling                                 TEXT,
  consolidatedcontract                             TEXT,
  countryoforigin                                  TEXT,
  placeofmanufacture                               TEXT,
  manufacturingorganizationtype                    TEXT,
  agencyid                                         TEXT,
  piid                                             TEXT,
  modnumber                                        TEXT,
  transactionnumber                                TEXT,
  fiscal_year                                      TEXT,
  idvagencyid                                      TEXT,
  idvpiid                                          TEXT,
  idvmodificationnumber                            TEXT,
  solicitationid                                   TEXT,
  extentcompeted                                   TEXT,
  reasonnotcompeted                                TEXT,
  numberofoffersreceived                           TEXT,
  commercialitemacquisitionprocedures              TEXT,
  commercialitemtestprogram                        TEXT,
  smallbusinesscompetitivenessdemonstrationprogram TEXT,
  a76action                                        TEXT,
  competitiveprocedures                            TEXT,
  solicitationprocedures                           TEXT,
  typeofsetaside                                   TEXT,
  localareasetaside                                TEXT,
  evaluatedpreference                              TEXT,
  fedbizopps                                       TEXT,
  research                                         TEXT,
  statutoryexceptiontofairopportunity              TEXT,
  organizationaltype                               TEXT,
  numberofemployees                                TEXT,
  annualrevenue                                    TEXT,
  firm8aflag                                       TEXT,
  hubzoneflag                                      TEXT,
  sdbflag                                          TEXT,
  issbacertifiedsmalldisadvantagedbusiness         TEXT,
  shelteredworkshopflag                            TEXT,
  hbcuflag                                         TEXT,
  educationalinstitutionflag                       TEXT,
  womenownedflag                                   TEXT,
  veteranownedflag                                 TEXT,
  srdvobflag                                       TEXT,
  localgovernmentflag                              TEXT,
  minorityinstitutionflag                          TEXT,
  aiobflag                                         TEXT,
  stategovernmentflag                              TEXT,
  federalgovernmentflag                            TEXT,
  minorityownedbusinessflag                        TEXT,
  apaobflag                                        TEXT,
  tribalgovernmentflag                             TEXT,
  baobflag                                         TEXT,
  naobflag                                         TEXT,
  saaobflag                                        TEXT,
  nonprofitorganizationflag                        TEXT,
  isothernotforprofitorganization                  TEXT,
  isforprofitorganization                          TEXT,
  isfoundation                                     TEXT,
  haobflag                                         TEXT,
  ishispanicservicinginstitution                   TEXT,
  emergingsmallbusinessflag                        TEXT,
  hospitalflag                                     TEXT,
  contractingofficerbusinesssizedetermination      TEXT,
  is1862landgrantcollege                           TEXT,
  is1890landgrantcollege                           TEXT,
  is1994landgrantcollege                           TEXT,
  isveterinarycollege                              TEXT,
  isveterinaryhospital                             TEXT,
  isprivateuniversityorcollege                     TEXT,
  isschoolofforestry                               TEXT,
  isstatecontrolledinstitutionofhigherlearning     TEXT,
  isserviceprovider                                TEXT,
  receivescontracts                                TEXT,
  receivesgrants                                   TEXT,
  receivescontractsandgrants                       TEXT,
  isairportauthority                               TEXT,
  iscouncilofgovernments                           TEXT,
  ishousingauthoritiespublicortribal               TEXT,
  isinterstateentity                               TEXT,
  isplanningcommission                             TEXT,
  isportauthority                                  TEXT,
  istransitauthority                               TEXT,
  issubchapterscorporation                         TEXT,
  islimitedliabilitycorporation                    TEXT,
  isforeignownedandlocated                         TEXT,
  isarchitectureandengineering                     TEXT,
  isdotcertifieddisadvantagedbusinessenterprise    TEXT,
  iscitylocalgovernment                            TEXT,
  iscommunitydevelopedcorporationownedfirm         TEXT,
  iscommunitydevelopmentcorporation                TEXT,
  isconstructionfirm                               TEXT,
  ismanufacturerofgoods                            TEXT,
  iscorporateentitynottaxexempt                    TEXT,
  iscountylocalgovernment                          TEXT,
  isdomesticshelter                                TEXT,
  isfederalgovernmentagency                        TEXT,
  isfederallyfundedresearchanddevelopmentcorp      TEXT,
  isforeigngovernment                              TEXT,
  isindiantribe                                    TEXT,
  isintermunicipallocalgovernment                  TEXT,
  isinternationalorganization                      TEXT,
  islaborsurplusareafirm                           TEXT,
  islocalgovernmentowned                           TEXT,
  ismunicipalitylocalgovernment                    TEXT,
  isnativehawaiianownedorganizationorfirm          TEXT,
  isotherbusinessororganization                    TEXT,
  isotherminorityowned                             TEXT,
  ispartnershiporlimitedliabilitypartnership       TEXT,
  isschooldistrictlocalgovernment                  TEXT,
  issmallagriculturalcooperative                   TEXT,
  issoleproprietorship                             TEXT,
  istownshiplocalgovernment                        TEXT,
  istriballyownedfirm                              TEXT,
  istribalcollege                                  TEXT,
  isalaskannativeownedcorporationorfirm            TEXT,
  iscorporateentitytaxexempt                       TEXT,
  iswomenownedsmallbusiness                        TEXT,
  isecondisadvwomenownedsmallbusiness              TEXT,
  isjointventurewomenownedsmallbusiness            TEXT,
  isjointventureecondisadvwomenownedsmallbusiness  TEXT,
  walshhealyact                                    TEXT,
  servicecontractact                               TEXT,
  davisbaconact                                    TEXT,
  clingercohenact                                  TEXT,
  otherstatutoryauthority                          TEXT,
  prime_awardee_executive1                         TEXT,
  prime_awardee_executive1_compensation            TEXT,
  prime_awardee_executive2                         TEXT,
  prime_awardee_executive2_compensation            TEXT,
  prime_awardee_executive3                         TEXT,
  prime_awardee_executive3_compensation            TEXT,
  prime_awardee_executive4                         TEXT,
  prime_awardee_executive4_compensation            TEXT,
  prime_awardee_executive5                         TEXT,
  prime_awardee_executive5_compensation            TEXT,
  interagencycontractingauthority                  TEXT,
  last_modified_date                               TEXT,
  CONSTRAINT pk_contract_csv PRIMARY KEY (unique_transaction_id, last_modified_date)
);